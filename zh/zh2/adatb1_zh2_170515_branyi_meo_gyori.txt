remélem legalább az elsőt meg tudtam csinálni.. CREATE TABLE NAPLO (
sorszam INT PRIMARY KEY,
datum DATE DEFAULT CURRENT_TIMESTAMP,
muvelet VARCHAR(255) CHECK (muvelet IN ('beszuras', 'modositas', 'torles')),
felhasznalo INT REFERENCES HALLGATOK(AZONOSITO)
);

CREATE OR REPLACE PROCEDURE kazetta_kolcsonzes(film_cime VARCHAR(255), ugyfel_igazolvanyszam INT) AS
BEGIN
IF ugyfel_igazolvanyszam NOT IN (SELECT IGAZOLVANYSZAM FROM UGYFEL) THEN
SQLERRM(ugyfel_igazolvanyszam + 'not found in the ugyfel table');
END IF;
IF film_cime IN (SELECT film_cime FROM FILM)
AND (SELECT COUNT(KAZON) FROM KAZETTA WHERE FAZON = (SELECT FAZON FROM FILM WHERE FILM_CIME = film_cime)
< (SELECT COUNT(KAZON) FROM KOLCSONZES WHERE KAZON = ALL (SELECT KAZON FROM KAZETTA WHERE FAZON = (SELECT FAZON FROM FILM WHERE FILM_CIME = film_cime))))
THEN
SQLERRM('shit happened');
END IF;
INSERT INTO KOLCSONZES (IGAZOLVANYSZAM, KAZON, ELVITEL_DATUMA) VALUES (ugyfel_igazolvanyszam,(SELECT KAZON FROM KAZETTA WHERE FAZON = (SELECT FAZON FROM FILM WHERE FILM_CIME = film_cime)), CURRENT_DATE);
END;
/